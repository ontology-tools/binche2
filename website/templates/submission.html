{% extends "base.html" %}

{% block head %}
<title>BinChe2</title>
{% endblock %}

{% block body %}

{% if user_study_set %}
<div style="padding: 20px 40px;">
    <!-- <h3 class="mb-3">You submitted:</h3> -->
    <!-- <p class="mb-4 text-body">{{ user_study_set.replace('\r\n', ', ').replace('\n', ', ') }}</p> -->
    <!-- <pre class="study-set mb-4">{{ user_study_set }}</pre> -->

    <h3 class="mt-4 mb-3">Pruning Strategies:</h3>
    <p>
    Either choose an existing looping pruning strategy or configure pruning options and correction method
    manually below.
    </p>

    <form action="/run_analysis" method="POST" class="needs-validation">
        <!-- LOOPING PRUNING METHOD -->
        <div class="mb-4">
            <div class="form-check">
                <input class="form-check-input" type="radio" name="looping_prune_method" id="plain_enrich" value="plain_enrich" required>
                <label class="form-check-label" for="plain_enrich">
                    Plain enrichment pruning strategy (no further selections needed)
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="looping_prune_method" id="no_loop_prune" value="no_loop_prune">
                <label class="form-check-label" for="no_loop_prune">
                    No looping pruning (customise options below)
                </label>
            </div>
        </div>

        <!-- P-VALUE CORRECTION METHOD -->
        <h4 class="mt-4 mb-3">Choose p-value correction method:</h4>
        <div class="mb-4">
            <label for="p_value_correction_method" class="form-label">P-value correction method:</label>
            <select name="p_value_correction_method" id="p_value_correction_method" class="form-select" style="max-width: 300px;">
                <option value="benjamini_hochberg">Benjamini-Hochberg</option>
                <option value="bonferroni">Bonferroni</option>
                <option value="none">None</option>
            </select>
        </div>

        <h4 class="mt-4 mb-3">Choose pruning methods:</h4>
        <!-- ROOT CHILDREN PRUNE -->
        <div class="form-check form-switch mb-2">
            <input type="checkbox" name="root_children_prune" value="true" class="form-check-input"
                id="root_children_prune">
            <label for="root_children_prune" class="form-check-label">
                Root-children pruning
            </label>
        </div>
        <div class="mb-4 ms-4">
            <label for="levels" class="form-label small text-muted">Levels (levels to prune including root):</label>
            <input type="number" name="levels" id="levels" value="2" min="0" class="form-control" style="max-width:150px;">
        </div>


        <!-- LINEAR BRANCH PRUNE -->
        <div class="form-check form-switch mb-2">
            <input type="checkbox" name="linear_branch_prune" value="true" class="form-check-input"
                id="linear_branch_prune">
            <label for="linear_branch_prune" class="form-check-label">
                Linear branch pruning
            </label>
        </div>
        <div class="mb-4 ms-4">
            <label for="linear_branch_n" class="form-label small text-muted">n (Keeps every n:th node in the branch. n=0 removes all intermediate nodes):</label>
            <input type="number" name="linear_branch_n" id="linear_branch_n" value="2" min="0" class="form-control" style="max-width:150px;">
        </div>

        <!-- HIGH P-VALUE PRUNE -->
        <div class="form-check form-switch mb-2">
            <input type="checkbox" name="high_p_value_prune" value="true" class="form-check-input"
                id="high_p_value_prune">
            <label for="high_p_value_prune" class="form-check-label">
                High p-value pruning
            </label>
        </div>
        <div class="mb-4 ms-4">
            <label for="p_value_threshold" class="form-label small text-muted">
                p-value threshold (a node with a higher p-value will be still be kept if it has a descendant with a
                p-value below the threshold):
            </label>
            <input type="number" name="p_value_threshold" id="p_value_threshold" value="0.05" step="0.01" min="0" max="1"
                class="form-control" style="max-width:150px;">
        </div>

        <!-- ZERO DEGREE PRUNE -->
        <div class="form-check form-switch mb-4">
            <input type="checkbox" name="zero_degree_prune" value="true" class="form-check-input"
                id="zero_degree_prune">
            <label for="zero_degree_prune" class="form-check-label">
                Zero-degree pruning
            </label>
        </div>

        <div class="mt-4 mb-3">
            <button type="submit" class="btn btn-primary">
                Run Analysis
            </button>
        </div>
    </form>
    {% else %}
    <div class="alert alert-warning mt-4" role="alert">
        <h2 class="alert-heading">No study set submitted.</h2>
        <hr>
        <a href="/" class="btn btn-primary">
            Back to homepage
        </a>
    </div>
    {% endif %}
</div>



{% endblock %}